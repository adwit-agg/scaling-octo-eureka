Below is a **spec doc** for the SMS-based PH flood-risk assistant, focused on **Barangay + City** location input. I‚Äôve also included the **data resources + easy tech choices** (Open-Meteo, GeoRisk hazard layers, Twilio, geocoding).

---

## Spec Doc: SMS Flood Risk Assistant (Philippines)

### 1) One-line summary

An **SMS-based early warning + guidance service** for the Philippines that turns (1) **forecast rainfall** and (2) **static flood susceptibility** into **location-targeted flood risk** and **actionable steps**, optimized for users with unreliable data but working SMS.

---

### 2) Goals and non-goals

**Goals**

* Work on any phone that can send/receive SMS.
* Allow users to register with **Barangay, City** and then get quick risk checks.
* Provide a **risk tier + time window + 2‚Äì5 actionable steps**.
* Support an **opt-in broadcast alert network** for high-risk areas.

**Non-goals (for hackathon scope)**

* Not predicting weather from scratch (we consume forecasts).
* Not guaranteeing flooding (‚Äúrisk likely‚Äù not ‚Äúwill flood‚Äù).
* Not building a full UI app.

---

### 3) User flows and requirements

#### A) Onboarding / Initialization

**User sends:**
`START <Barangay>, <City>`
Example: `START Brgy Lahug, Cebu City`

**System requirements**

* Parse location as: **Barangay + City** (minimum: City if needed, but barangay strongly preferred).
* Resolve to a coordinate (lat/lon) using a geocoder.
* If ambiguous/low confidence, reply with **disambiguation options**:

  * ‚ÄúReply 1/2/3‚Äù with the correct match.
* Save to profile:

  * phone number ‚Üí barangay, city, lat/lon, timestamp, opted-in status

**Success response**

* Confirm saved location
* Immediately run a risk check and respond with either ‚Äúdanger‚Äù response or ‚Äúmenu-only‚Äù response

---

#### B) Immediate ‚Äúdanger‚Äù response (when risk is High/Severe)

**Required response format (SMS-optimized)**

* **Risk tier:** HIGH / SEVERE
* **When:** next 3h / next 24h peak window
* **Why:** heavy rain soon + flood-prone area
* **Top actions (2‚Äì5):** short imperative steps
* **Menu options:** numbered

Example structure:

* `RISK: HIGH (next 3h)`
* `WHY: Heavy rain expected + flood-prone area`
* `DO NOW: 1) Charge phone/powerbank 2) Move valuables up 3) Prep go-bag`
* `MENU: Reply 1 Risk, 2 Home prep, 3 Travel, 4 Farmer, 5 Update loc, WHY details`

---

#### C) Not in danger ‚Üí menu response

If risk is Low/Elevated, return:

* quick status line + menu

Example:

* `RISK: LOW (next 24h)`
* `MENU: 1 Risk check 2 Home prep 3 Travel 4 Farmer 5 Update loc WHY details`

---

#### D) Menu option specs

**1) Risk assessment**

* Returns:

  * risk tier now / next 3h / next 24h
  * one-sentence explanation (‚Äúforecast rain X + susceptibility Y‚Äù)
  * 1‚Äì3 recommended actions appropriate to tier

**2) Home prep checklist**

* Returns short checklist tailored to tier (Low vs Elevated vs High)
* Keep under ~1‚Äì2 SMS segments if possible

**3) Travel safety**

* Returns travel recommendation based on near-term risk:

  * ‚ÄúAvoid low-lying roads; delay travel until after [time]‚Äù (without claiming road closures)

**4) Farmer mode**

* Interpret the user intent: planting/harvesting/livestock protection
* Output is action-oriented:

  * ‚ÄúDelay planting today if heavy rain within 6h‚Äù
  * ‚ÄúMove equipment to higher ground‚Äù
* Must be conservative and clearly tied to forecast window

**5) Update location**

* `LOC <Barangay>, <City>` triggers re-geocode and re-save

**WHY**

* Returns ‚Äúexplainability payload‚Äù:

  * forecast rainfall summary window
  * susceptibility category label
  * last updated timestamp and sources

**STOP**

* Unsubscribe from all proactive alerts (required for responsible SMS service)

---

### 4) Risk model spec (interpretable, demo-friendly)

**Inputs**

* Flood susceptibility (static): Low / Moderate / High / Very High (from GeoRisk hazard layers)
* Forecast rainfall (dynamic): derived from hourly precipitation forecast at lat/lon

**Derived rainfall metrics**

* `rain_3h_total` (sum next 3 hours)
* `rain_6h_peak` (max hourly rain next 6 hours)
* `rain_24h_total` (sum next 24 hours)

**Outputs**

* Rain severity: Light / Moderate / Heavy / Extreme
* Final risk tier: Low / Elevated / High / Severe

**Combination rule**

* Use a lookup table or score:

  * higher susceptibility + heavier near-term rain ‚áí higher risk
* Safety bias: in **High/Very High susceptibility**, shift borderline cases upward (avoid missing dangerous cases)

**Language constraints**

* Never say ‚Äúwill flood‚Äù; say ‚Äúflood risk high / flooding likely‚Äù

---

### 5) Broadcast alerts (opt-in network)

**Concept**

* Users opt-in (default opt-in during onboarding, but must allow STOP).
* Periodically evaluate risk for each stored user location and push alerts when:

  * risk crosses threshold (e.g., Elevated‚ÜíHigh)
  * Severe risk detected

**Alert content**

* Risk tier + time window + 1‚Äì2 actions + ‚ÄúReply 1 for details / 5 to update location / STOP to unsubscribe‚Äù

---

## Data resources

### Weather forecasts: Open-Meteo

* Use Open-Meteo‚Äôs forecast API (no API key needed in many cases) and request **hourly precipitation** for the user coordinate. ([Open Meteo][1])
* (Optional extension) Open-Meteo also has historical/archived forecast endpoints you can use later to evaluate how your thresholds would have performed. ([Open Meteo][2])

### Flood susceptibility: GeoRisk PH hazard layers (static)

* GeoRisk hosts an ArcGIS REST directory with public hazard map services, including an **MGBPublic/Flood (MapServer)** layer used for flood susceptibility context. ([Ulap Hazards][3])
* HazardHunterPH (GeoRisk) explicitly lists ‚ÄúFlood (MGB)‚Äù as a hazard layer (useful for citing that this is a real, agency-sourced layer in the GeoRisk ecosystem). ([HazardHunterPH][4])

### Geocoding (Barangay, City ‚Üí lat/lon)

* Nominatim (OpenStreetMap geocoding) can resolve place names to coordinates and supports a search endpoint. ([Nominatim][5])
* Important product note: the public Nominatim instance has a usage policy; for production you‚Äôd want a paid geocoder or self-host / managed provider, but for a hackathon it‚Äôs often fine if you keep volume low. ([OSMF Operations][6])

---

## Technologies that make this easy (hackathon-friendly)

### SMS: Twilio

* Twilio supports receiving incoming SMS via **webhooks** (Twilio sends an HTTP request to your webhook URL when an SMS arrives). ([Twilio][7])
* Twilio‚Äôs Programmable Messaging API is built for sending replies + handling messaging events. ([Twilio][8])

### Simple backend choices (pick one)

* **Node/Express** or **Python/FastAPI**: easiest to implement webhook + call APIs.
* Deploy: **Render / Railway / Fly.io / Vercel (serverless)** ‚Äî anything that can expose a public HTTPS endpoint for Twilio webhooks (Twilio requires a publicly reachable URL). ([Twilio][9])

### Storage (minimal but necessary)

* Store user profiles: `phone ‚Üí barangay, city, lat/lon, opted_in`
* Options:

  * SQLite (quick), Postgres (clean), Firebase/Supabase (fast setup)

---

## What you‚Äôll say in the demo (credibility points)

* ‚ÄúWe **don‚Äôt replace meteorology** ‚Äî we translate rainfall forecasts into **flood risk + actions**.‚Äù
* ‚ÄúWe combine **Open-Meteo rainfall forecasts** with **GeoRisk flood susceptibility** to generate a tiered warning.‚Äù ([Open Meteo][10])
* ‚ÄúWe deliver it via **SMS** using Twilio webhooks, so it works even when mobile data is unreliable.‚Äù ([Twilio][7])

---

If you want, I can next produce:

* a **complete SMS script** for your demo (onboarding, dangerous case, farmer case, disambiguation case, STOP), and
* a concrete **risk-tier table** (thresholds on rain_3h_total / rain_6h_peak √ó susceptibility) that stays simple but feels ‚Äúscientific.‚Äù

[1]: https://open-meteo.com/?utm_source=chatgpt.com "Open-Meteo.com: üå§Ô∏è Free Open-Source Weather API"
[2]: https://open-meteo.com/en/docs/historical-forecast-api?utm_source=chatgpt.com "Historical Forecast API"
[3]: https://ulap-hazards.georisk.gov.ph/arcgis/rest/services/MGBPublic?utm_source=chatgpt.com "Folder: MGBPublic"
[4]: https://hazardhunter.georisk.gov.ph/map?utm_source=chatgpt.com "flood hazard map"
[5]: https://nominatim.org/release-docs/latest/api/Overview/?utm_source=chatgpt.com "Overview - Nominatim 5.2.0 Manual"
[6]: https://operations.osmfoundation.org/policies/nominatim/?utm_source=chatgpt.com "Nominatim Usage Policy (aka Geocoding Policy)"
[7]: https://www.twilio.com/docs/usage/webhooks/messaging-webhooks?utm_source=chatgpt.com "Messaging Webhooks"
[8]: https://www.twilio.com/en-us/messaging/programmable-messaging-api?utm_source=chatgpt.com "Programmable Messaging API"
[9]: https://www.twilio.com/docs/usage/webhooks/webhooks-overview?utm_source=chatgpt.com "Webhooks Overview"
[10]: https://open-meteo.com/en/docs?utm_source=chatgpt.com "Weather Forecast API"
